# Применение моделей глубинного обучения

В ходе выполненной работы использовались модели:
- ResNet50
- EfficientNet
- Yolo 11

Модели были изменены и дообучены для работы с классификацией изображений из [датасета проекта](../dataset.md)

Текущий датасет уже содержит в себе аугменатции изображений, аугментации были добавлены при [сборе датасета](../EDA/Notebooks/dataset_merging.ipynb)

## Модель ResNet50

[Ноутбук с ResNet50](./ResNet50_model.ipynb)

Была использована модель [ResNet50](https://docs.pytorch.org/vision/main/models/generated/torchvision.models.resnet50.html), предобученная на датасете [ImageNet](https://www.image-net.org/)

* Заменён последний слой `model.fc (fully connected)` на новый Linear, соответствующий количеству классов (32). <br>
Таким образом, модель теперь возвращает выход размерности num_classes, а не стандартные 1000 классов из ImageNet

### Результаты модели после обучения:
- **Train loss**: 0.0025
- **Train accuracy**: 97.56%
- **Validation loss**: 0.0024
- **Validation accuracy**: 97.90%

## Модель EfficientNet-B0

[Ноутбук с EfficientNet-B0](./EfficientNet_model.ipynb)

* Полностью заменён классификатор `model.classifier`, состоящий из:
    * Dropout для регуляризации,
    * Linear слой с уменьшением размерности признаков до 256,
    * ReLU и BatchNorm1d для стабилизации и ускорения обучения,
    * Финальный Linear слой с размерностью num_classes — под конкретную задачу классификации.

Изменения классификатора позволили модели быть более гибкой и устойчивой к переобучению.

### Результаты модели после обучения:
- **Train loss**: 0.0572
- **Train accuracy**: 98.32%
- **Validation loss**: 0.0434
- **Validation accuracy**: 98.82%

## Модель Yolo11

[Ноутбук с Yolo11](./Yolo_model.ipynb)

* Добавлен слой Dropout в голову модели и изменен выход линейного слоя на 32 класса
  
Добавление слоя позволили модели быть более устойчивой к переобучению.

### Результаты модели после обучения:
- **Validation loss**: 0.0285
- **Validation accuracy**: 99.1%

## Сравнение моделей ML и DL для задачи классификации изображений
Ранее были проведены эксперименты с подбором [ML моделей](../MLModels/ml_models.md):
* Классические модели показали достойные результаты при правильной настройке признаков и гиперпараметров
* Их производительность ограничена эффективностью ручного извлечения признаков.

### Сравнение количества параметров:
- ResNet50 - 25.56 млн
- EfficientNet-B0 - 5.29 млн
- Yolo11 - 1.6 млн

Проведенная работа с моделями глубинного обучения показала:
* Признаки извлекаются автоматически на основе архитектуры модели
* Не требует ручной настройки фичей
* Эффективно масштабируется с большим количеством данных
* Показывает стабильно высокий результат после обучения.

| Подход | Требует ручной работы с признаками | Лучшая accuracy         | Масштабируемость | Обобщающая способность |
| ------ | ---------------------------------- | ----------------------- | ---------------- | ---------------------- |
| **ML** | Да (HOG, SIFT, PCA)                | 0.79 (CatBoost)         | Ограничена       | Средняя                |
| **DL** | Нет (автоматическое извлечение)    | 0.991 (Yolo11)          | Высокая          | Высокая                |


## Вывод:
Модели были успешно адаптированы под задачу классификации с использованием предобученных весов и показали высокую точность и стабильные результаты на валидационной выборке. **Особенно хорошо себя показали модели EfficientNet-B0 и Yolo11**, которые продемонстрировали лучшую обобщающую способность и могут быть выбраны для дальнейшего использования.

**Модели глубокого обучения показали значительно более высокие метрики по сравнению с ML-подходами.**

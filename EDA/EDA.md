# Разведочный анализ (EDA) датасета изображений овощей и фруктов
Для разведочного анализа используется подготовленный датасет, состоящий из изображений овощей и фруктов.
Разведочный анализ каждого датасета по отдельности:
- [EDA Fruits360](./EDA_Fruits360.md)
- [EDA Vegetables](./EDA_Vegetables.md)
- [EDA tasty_fruit](./EDA_tasty_fruit.md)

[Ноутбук с подготовкой датасета](Notebooks/dataset_merging.ipynb) - При подготовке датасета были объединены классы и применен oversampling путем изменения контрастности, яркости, угла и отзеркаливания изображений и undersampling путем отбрасывания случайных изображений из класса для балансировки.
**В датасете представлено 33 класса по 1400 изображений в каждом.**
[Ноутбук с EDA датасета изображений](Notebooks/EDA.ipynb)
## Общая информация о данных
### Средние, минимальные и максимальные размеры изображений
* Среднее значение ширины - 180px, высоты - 171px
* Минимальные размеры для ширины и высоты - 100px. Значительная часть (около 25% датасета) представлена в таком размере.
* Максимальное значение для ширины - 453px, высоты - 363px.

Половина изображений имеют ширину до 224px и высоту до 194px, а три четверти изображений имеют размер по ширине и высоте до 224px.
### Средние значения и отклонения по каналам (R, G, B)
Средние значения и стандартные отклонения по каналам сильно варьируется от класса к классу. В некоторых классах имеются похожие изображения (изображения одного и того же объекта под разными углами, к примеру), это сказывается на стандартном отклонении.
### Метаданные изображений
У 4234 изображений из 46200 присутствуют EXIF-данные.
Для анализа были взяты: `model, aperture_value, brightness_value, focal_length, digital_zoom_ratio`
При визуальном изучении стало заметно, что изображения с различным фокусным расстоянием и яркостью отличаются друг от друга по этим признакам.
Также качество изображений отличается в зависимости от модели камеры.
### Изучение связи изображений с целевой переменной
При визуальном анализе нескольких примеров изображений из каждого класса было обнаружено:
* Для класса **Tomato**:
Большая часть изображений в данном классе растянуты и сплюснуты.
* Для класса **Radish**:
Редис на изображениях светлый и вытянутый. Так же бывает круглый и красный редис, но в датасете такие не представлены
* Для класса **Brinjal**:
Все баклажаны в датасете зеленого цвета. Баклажаны чаще встречаются фиолетового цвета, в датасете не представлены.
* Для класса **Pumpkin**:
Тыквы в датасете все зеленоватого цвета, больше похожи на арбуз. Тыквы часто бывают оранжевого или рыжего цвета, но в датасете не представлены
* **Небольшие изображения (100*100px)** при увеличении имеют низкое качество. В будущем это может плохо сказаться на обучении модели, так как такие изображения содержат маленькую детализацию и объект на них тяжелее классифицировать.
* Присутствуют изображения с измененной контрастностью и резкостью.
* Также присутствуют изображения повернутые на угол. У таких изображений в углах с отсутствием изображения залит белый цвет.
## Дубликаты изображений
С помощью сравнения хеша изображений **были найдены дубликаты**. Дубликаты изображений **были изменены  при помощи отзеркаливания, поворота на угол, изменения яркости и контрастности.**
## Баланс классов
В каждом классе имеется 1400 изображений. Датасет хорошо сбалансирован.
## Размер изображений
Изображения в датасете имеют разный размер. Перед обучением модели изображения следует привести к единому размеру.
При изменении размера изображений к 224x224px большинство изображений не потеряет деталей, также **данный размер используется в нейронных сетях ResNet, VGG**.
При приведении датасета к данному размеру многие изображения не придется изменять. Крупных изображений немного, их можно уменьшить без сильной потери информации.
Также следует провести эксперименты с обучением модели на различных размерах: 64x64, 100x100 128x128, 192x192. Проверка обучения моделей на разных размерах позволит качественнее подобрать размер изображений.

**Оптимальный размер для изображений - 224x224px. Стоит провести обучение на разных размерах, чтобы лучше определить подходящий.**
## Выбросы
1. Представлено 2 класса клубники: Strawberry и Strawberries. Следует объединить данные классы в один путем удаления части изображений из Strawberry и добавления части изображений из Strawberries в Strawberry (60% Strawberries и 40% Strawberry, к примеру), затем класс Strawberries удалить.
2. Присутствуют изображения сильно крупнее большинства других и изображения размером 100*100px.
   При изменении размера изображений:
   - Крупные не сильно повлияют на качество модели, т.к. их немного
   - Изображения 100*100px имеют низкую детализацию, объект на них может быть сложно классифицировать
